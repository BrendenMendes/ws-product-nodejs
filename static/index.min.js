var option,myChart,stackedBar={};function loadChart(){let a=document.getElementById("myChart").getContext("2d");myChart&&(myChart=null),myChart=new Chart(a,{type:"bar",data:stackedBar,options:{scales:{xAxes:[{stacked:!0}],yAxes:[{stacked:!0}]}}})}function addData(a,e,t){a.data.labels.push(e),a.data.datasets.forEach(a=>{a.data.push(t)}),a.update()}function removeData(a){a.data.labels.pop(),a.data.datasets.forEach(a=>{a.data.pop()}),a.update(),console.log(a)}$(function(){$("#options :input").change(function(){option=this.id,console.log(option),$("#search-data").prop("disabled",!1)}),$("#search-data").click(async function(){let a=new Date($("#from-option").val()),e=new Date($("#to-input-option").val());a.getTime()<e.getTime()?(removeData(myChart),removeData(myChart),removeData(myChart),removeData(myChart),removeData(myChart),removeData(myChart),removeData(myChart),await function(a,e,t){console.log(e,t),"events"==a?$.ajax("/events/"+e+"/"+t,{type:"GET",success:function(a,e,t){if(a.length>0){let e=[],t=[],o=[],r=[],n=[],s=0,l=0,d=0,c=0;for(let p=0;p<a.length;p++)e.push(a[p].date.replace("T05:00:00.000Z","")),a.indexOf(a[p])+1!=a.length&&a[p].date==a[p+1].date?a[p].hour<6?s+=a[p].events:a[p].hour<12?l+=a[p].events:a[p].hour<18?d+=a[p].events:c+=a[p].events:(a[p].hour<6?s+=a[p].events:a[p].hour<12?l+=a[p].events:a[p].hour<18?d+=a[p].events:c+=a[p].events,n.push(s),t.push(l),o.push(d),r.push(c),s=0,l=0,d=0,c=0);e=[...new Set(e)],stackedBar={labels:e,datasets:[{label:"night (12am - 6am)",data:n,backgroundColor:"rgb(75, 192, 192)"},{label:"morning (6am - 12pm)",data:t,backgroundColor:"rgb(255, 205, 86)"},{label:"afternoon (12pm - 6pm)",data:o,backgroundColor:"rgb(255, 99, 132)"},{label:"evening (6pm - 12am)",data:r,backgroundColor:"rgb(54, 162, 235)"}]},console.log(stackedBar),loadChart()}else alert("no data present")},error:function(a,e,t){alert("issue with system")}}):(console.log(e,t),$.ajax("/stats/"+e+"/"+t,{type:"GET",success:function(a,e,t){if(console.log(a),a.length>0){let e=[],t=[],o=[],r=[];for(let n=0;n<a.length;n++)e.push(a[n].date.replace("T05:00:00.000Z","")),t.push(a[n].impressions),o.push(a[n].clicks),r.push(a[n].revenue);e=[...new Set(e)],stackedBar={},stackedBar={labels:e,datasets:[{label:"impressions",data:t,backgroundColor:"rgb(54, 162, 235)"},{label:"clicks",data:o,backgroundColor:"rgb(255, 205, 86)"},{label:"revenue",data:r,backgroundColor:"rgb(255, 99, 132)"}]},loadChart()}else alert("no data present")},error:function(a,e,t){alert("issue with system")}}))}(option,$("#from-option").val().replace("-","").replace("-",""),$("#to-input-option").val().replace("-","").replace("-",""))):alert("Enter a valid date range")})});